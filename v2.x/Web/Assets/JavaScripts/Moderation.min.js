var Moderation={_markCommentAsOffendedUrl:"",_spamCommentUrl:"",_deleteStoryUrl:"",_spamStoryUrl:"",_approveStoryUrl:"",_getStoryUrl:"",_centerMeTimer:null,set_markCommentAsOffendedUrl:function(A){Moderation._markCommentAsOffendedUrl=A},set_spamCommentUrl:function(A){Moderation._spamCommentUrl=A},set_deleteStoryUrl:function(A){Moderation._deleteStoryUrl=A},set_spamStoryUrl:function(A){Moderation._spamStoryUrl=A},set_approveStoryUrl:function(A){Moderation._approveStoryUrl=A},set_getStoryUrl:function(A){Moderation._getStoryUrl=A},init:function(){$("#storyEditorBox").keydown(function(A){if(A.keyCode===27){Moderation._hide()}});$("#storyEditorClose").click(function(){Moderation._hide()});$("#frmStoryUpdate").validate({rules:{name:"required",createdAt:"required",description:{required:true,rangelength:[8,2048]},category:"required"},messages:{name:"Name cannot be blank.",createdAt:"Created At cannot be blank.",title:{required:"Title cannot be blank.",maxlength:"Title cannot be more than 256 character."},description:{required:"Description cannot be blank.",rangelength:"Description must be between 8 to 2048 character."},category:"Category must be selected."},submitHandler:function(B){var A={dataType:"json",beforeSubmit:function(C,E,D){$("#updateStoryMessage").text("").css("color","").hide();$U.disableInputs("#frmStoryUpdate",true);$U.showProgress("Updating Story...","#btnUpdateStory")},success:function(C){$U.disableInputs("#frmStoryUpdate",false);$U.hideProgress();if(C.isSuccessful){Moderation._hide()}else{$("#updateStoryMessage").text(C.errorMessage).css({color:"#ff0000",display:"block"})}}};$(B).ajaxSubmit(A)},errorPlacement:function(A,B){B.parents("p:first").find("span.error").text(A.text())},highlight:function(B,A){$(B).parents("p:first").find("span.error").show()},unhighlight:function(B,A){$(B).parents("p:first").find("span.error").hide()}})},dispose:function(){},editStory:function(B){var A="id="+encodeURIComponent(B);$U.disableInputs("#frmStoryUpdate",true);$.ajax({url:Moderation._getStoryUrl,type:"POST",dataType:"json",data:A,beforeSend:function(){$U.showProgress("Loading Story...")},success:function(C){$U.hideProgress();$U.disableInputs("#frmStoryUpdate",false);if(C.errorMessage){$U.messageBox("Error",C.errorMessage,true)}else{$U.blockUI();var D=$("#storyEditorBox");$("span.error").hide();$("span.message").hide();$("#hidStoryId").val(C.id);$("#txtStoryName").val(C.name);$("#txtStoryCreatedAt").val(C.createdAt);$("#txtStoryTitle").val(C.title);$("#txtStoryDescription").val(C.description);$("#txtStoryTags").val(C.tags);$("#frmStoryUpdate input[@type=radio]").each(function(){var E=$(this)[0];if(E.value==C.category){E.checked=true}});$U.center(D);D.fadeIn();Moderation._centerMe()}}})},approveStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._approveStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Approving Story...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Error",D.errorMessage,true)}}})}$U.confirm("Approve Story?","Are you sure you want to approve this story?",A)},deleteStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._deleteStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Deleting Story...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Error",D.errorMessage,true)}}})}$U.confirm("Delete Story?","Are you sure you want to delete this story?",A)},confirmSpamStory:function(B){function A(){var C="id="+encodeURIComponent(B);$.ajax({url:Moderation._spamStoryUrl,type:"POST",dataType:"json",data:C,beforeSend:function(){$U.showProgress("Approving Story Spam...")},success:function(D){$U.hideProgress();if(D.isSuccessful){$("#t-"+B).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Error",D.errorMessage,true)}}})}$U.confirm("Approve Story Spam?","Are you sure you want to approve this story as spam?",A)},confirmSpamComment:function(C,A){function B(){var D={storyId:C,commentId:A};$.ajax({url:Moderation._spamCommentUrl,type:"POST",dataType:"json",data:D,beforeSend:function(){$U.showProgress("Approving Comment Spam...")},success:function(E){$U.hideProgress();if(E.isSuccessful){$("#li-"+A).fadeOut("normal",function(){$(this).remove()})}else{$U.messageBox("Error",E.errorMessage,true)}}})}$U.confirm("Approve Spam Comment?","Are you sure you want to approve this comment as spam?",B)},markCommentAsOffended:function(C,A){function B(){var D={storyId:C,commentId:A};$.ajax({url:Moderation._markCommentAsOffendedUrl,type:"POST",dataType:"json",data:D,beforeSend:function(){$U.showProgress("Marking Offended...")},success:function(E){$U.hideProgress();if(E.isSuccessful){$U.messageBox("Success","Comment has been marked as offended.",false)}else{$U.messageBox("Error",E.errorMessage,true)}}})}$U.confirm("Mark Offended?","Are you sure you want to mark this comment as offended?",B)},_hide:function(){$U.disableInputs("#storyEditorBox",false);$U.hideProgress();Moderation._clearCenterMeTimer();$("#storyEditorBox").fadeOut("normal",function(){$U.unblockUI()})},_centerMe:function(){var A=$("#storyEditorBox");$U.center(A);Moderation._clearCenterMeTimer();Moderation._centerMeTimer=setInterval(function(){Moderation._centerMe()},2000)},_clearCenterMeTimer:function(){if(Moderation._centerMeTimer!=null){clearInterval(Moderation._centerMeTimer);Moderation._centerMeTimer=null}}};